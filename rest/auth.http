### =========================
### Config (Laragon/CI4)
### AJUSTA según cómo sirves el proyecto:
### - Si usas VirtualHost apuntando a /public:  http://ci4vue2026.test
### - Si usas localhost normal:                 http://localhost/
### =========================


@host = http://localhost/

@baseUrl = {{host}}/api/v1

### =========================
### Credenciales seed (CoreSeeder)
### =========================
@userId = 1
@email = admin@demo.local
@password = admin123

@tenantId = 1
@tenantName = Empresa Demo

@branchId = 1
@branchCode = MAIN
@branchName = Sucursal Principal

@roleId = 1
@roleName = SuperAdmin

# Token (lo pegas tras el login)
@accessToken = REEMPLAZA_CON_TOKEN

### =========================
### 0) PING (debug rápido)
### Si esto falla (404 HTML), NO estás llegando a CI4 (problema /public o rewrite)
### =========================
GET {{host}}/index.php
Accept: text/html


### =========================
### 1) LOGIN (sin token) - debe PERMITIR
### Esperado: 200 success + access_token
### =========================
POST {{baseUrl}}/auth/login
Content-Type: application/json
Accept: application/json

{
  "tenant_id": {{tenantId}},
  "email": "{{email}}",
  "password": "{{password}}"
}


### =========================
### 2) ME (con token) - debe PERMITIR
### Esperado: 200 success
### =========================
GET {{baseUrl}}/auth/me
Accept: application/json
Authorization: Bearer {{accessToken}}


### =========================
### 3) LOGIN (con token) - si tienes NoAuthFilter debería BLOQUEAR
### Nota: esto depende de que hayas aplicado NoAuthFilter a /auth/login
### Esperado: 409 o 403 (según tu diseño)
### =========================
POST {{baseUrl}}/auth/login
Content-Type: application/json
Accept: application/json
Authorization: Bearer {{accessToken}}

{
  "tenant_id": {{tenantId}},
  "email": "{{email}}",
  "password": "{{password}}"
}


### =========================
### 4) LOGOUT - sin token (debe BLOQUEAR si AuthFilter está aplicado)
### Esperado: 401
### =========================
POST {{baseUrl}}/auth/logout
Content-Type: application/json
Accept: application/json

{}


### =========================
### 5) LOGOUT - token inválido (debe BLOQUEAR)
### Esperado: 401
### =========================
POST {{baseUrl}}/auth/logout
Content-Type: application/json
Accept: application/json
Authorization: Bearer ESTE_TOKEN_NO_EXISTE

{}


### =========================
### 6) LOGOUT - token válido (debe PERMITIR)
### Esperado: 200 success (o 204 noContent)
### =========================
POST {{baseUrl}}/auth/logout
Content-Type: application/json
Accept: application/json
Authorization: Bearer {{accessToken}}

{}


### =========================
### 7) USERS - sin token (debe BLOQUEAR si AuthFilter)
### Esperado: 401
### =========================
GET {{baseUrl}}/users
Accept: application/json


### =========================
### 8) USERS - con token (debe PERMITIR)
### =========================
GET {{baseUrl}}/users
Accept: application/json
Authorization: Bearer {{accessToken}}
